function readURL(input, id) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();
        reader.onload = function(e) {
            $('#' + id).attr('src', e.target.result);
        };

        reader.readAsDataURL(input.files[0]);

    }
}

function check_file_type(input, id, id_show, type1) {
    if (type1 == "image1111") {
        var file = input.files[0];
        if (file.size >= 10 * 1024 * 1024) {
            $('#' + id).val('');
            alert("File size must be at most 10MB");
            return;
        }
        if (!file.type.match("image/*")) {
            $('#' + id).val('');
            alert("Please Upload JPG/JPEG/PNG/GIF File");

            return;
        }
        var fileReader = new FileReader();
        fileReader.onloadend = function(e) {
            var arr = (new Uint8Array(e.target.result)).subarray(0, 4);
            var header = "";
            for (var i = 0; i < arr.length; i++) {
                header += arr[i].toString(16);
            }
            if (mimeType(header) == 1) {
                $('#' + id).val('');
                alert("Please Upload JPG/JPEG/PNG/GIF File");

            }
        };
        fileReader.readAsArrayBuffer(file);
        readURL(input, id_show);
    } else {

        var file = input.files[0];
        if (file.size >= 10 * 1024 * 1024) {
            $('#' + id).val('');
            alert("File size must be at most 10MB");

            return;
        }

        var fileReader = new FileReader();
        fileReader.onloadend = function(e) {
            var arr = (new Uint8Array(e.target.result)).subarray(0, 4);
            var header = "";
            for (var i = 0; i < arr.length; i++) {
                header += arr[i].toString(16);
            }
            if (mimeType(header) == 1) {
                $('#' + id).val('');
                alert("Please Upload JPG/JPEG/PNG/GIF/PDF/DOC File");

            }
        };
        fileReader.readAsArrayBuffer(file);
        readURL(input, id_show);
    }

}

function mimeType(headerString) {
    switch (headerString) {
        case "89504e47":
            type = "image/png";
            break;
        case "47494638":
            type = "image/gif";
            break;
        case "ffd8ffe0":
        case "ffd8ffe1":
        case "ffd8ffe2":
            type = "image/jpeg";
            break;
        case "25504446":
            type = "application/pdf";
            break;
        case "d0cf11e0":
            type = "application/doc";
            break;
        default:
            type = "1";
            break;
    }
    return type;
}

function open_file1(image_type, table_name, match_field, data) {
    $.ajax({
        address: "POST",
        url: access_link + "attachment/ajax_open_image.php?image_type=" + image_type + "&data=" + data + "&match_field=" + match_field + "&table_name=" + table_name + "",
        cache: false,
        success: function(detail) {
            $("#mypdf_view").html(detail);
        }
    });
}